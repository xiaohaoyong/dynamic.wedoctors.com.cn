<?php
namespace app\components\vendor;
use yii\helpers\Inflector;
use yii\redis\Connection;

/**
 * Created by PhpStorm.
 * redis key前缀功能
 * User: wangzhen
 * Date: 2016/10/14
 * Time: 11:25
 */
class RedisConnection extends Connection
{
    public $prefix="";

    public $redisKeyCommands=[
        'PFADD',
        'PFCOUNT',
        'PGMERGE',
        'ZADD',
        'ZCARD',
        'ZCOUNT',
        'ZINCRBY',
        'ZINTERSTORE',
        'ZLEXCOUNT',
        'ZRANGE',
        'ZRANGEBYLEX',
        'ZRANGEBYSCOR',
        'ZRANK',
        'ZREM',
        'ZREMRANGEBYL',
        'ZREMRANGEBYR',
        'ZREMRANGEBYS',
        'ZREVRANGE',
        'ZREVRANGEBYS',
        'ZREVRANK',
        'ZSCORE',
        'ZUNIONSTORE',
        'ZSCAN',
        'SADD',
        'SCARD',
        'SDIFF',
        'SDIFFSTORE',
        'SINTER',
        'SINTERSTORE',
        'SISMEMBER',
        'SMEMBERS',
        'SMOVE',
        'SPOP',
        'SRANDMEMBER',
        'SREM',
        'SUNION',
        'SUNIONSTORE',
        'SSCAN',
        'BLPOP',
        'BRPOP',
        'BRPOPLPUSH',
        'LINDEX',
        'LINSERT',
        'LLEN',
        'LPOP',
        'LPUSH',
        'LPUSHX',
        'LRANGE',
        'LREM',
        'LSET',
        'LTRIM',
        'RPOP',
        'RPOPLPUSH',
        'RPUSH',
        'RPUSHX',
        'HDEL',
        'HEXISTS',
        'HGET',
        'HGETALL',
        'HINCRBY',
        'HINCRBYFLOAT',
        'HKEYS',
        'HLEN',
        'HMGET',
        'HMSET',
        'HSET',
        'HSETNX',
        'HVALS',
        'SET',
        'GET',
        'GETRANGE',
        'GETSET',
        'GETBIT',
        'MGET',
        'SETBIT',
        'SETEX',
        'SETNX',
        'SETRANGE',
        'STRLEN',
        'MSET',
        'MSETNX',
        'PSETEX',
        'INCR',
        'INCRBY',
        'INCRBYFLOAT',
        'DECR',
        'DECRBY',
        'APPEND',
        'DEL',
        'DUMP',
        'EXISTS',
        'EXPIRE',
        'EXPIREAT',
        'PEXPIREAT',
        'PEXPIREAT',
        'KEYS',
        'MOVE',
        'PERSIST',
        'PTTL',
        'TTL',
        'RANDOMKEY',
        'RENAME',
        'RENAMENX',
        'TYPE'
    ];
    public function executeCommand($name, $params = [])
    {
        $redisCommand = strtoupper(Inflector::camel2words($name, false));
        if(is_array($params) && $this->prefix && in_array($redisCommand,$this->redisKeyCommands)){
            $params[0]=$this->prefix.$params[0];
        }
        return parent::executeCommand($name, $params); // TODO: Change the autogenerated stub
    }

}